#!/usr/bin/env python3
"""
Description: Beautifies HTML; called by format

Author: Andy Roper <andyroper42@gmail.com>
URL: https://github.com/andy-roper/roperdot
"""

import sys
from bs4 import BeautifulSoup

if len(sys.argv) != 2:
    print("Usage: beautify-html <file.html>")
    sys.exit(1)

with open(sys.argv[1], 'r') as f:
    soup = BeautifulSoup(f.read(), 'html.parser')

# Get prettified HTML and replace single spaces with 4 spaces
prettified = soup.prettify()
lines = prettified.split('\n')
result = []
for line in lines:
    # Count leading spaces and multiply by 4
    leading_spaces = len(line) - len(line.lstrip(' '))
    if leading_spaces > 0:
        result.append('    ' * leading_spaces + line.lstrip(' '))
    else:
        result.append(line)

print('\n'.join(result))